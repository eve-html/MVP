<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ - ProjectMarket</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">ProjectMarket</a>
                <a href="/create" class="btn">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</a>
            </div>
        </div>
    </header>
    
    <main class="container">
        <a href="/" class="back-btn">‚Üê –ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç–∞–º</a>
        
        <div id="loading" class="loading">
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞...</p>
        </div>
        
        <div id="error-container" class="error" style="display: none;"></div>
        
        <div id="project-detail" class="project-detail" style="display: none;">
            <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
        </div>
    </main>
    
    <footer>
        <div class="container">
            <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –†–æ—Å—Å–∏–∏</p>
        </div>
    </footer>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const projectId = urlParams.get('id');
            const projectContainer = document.getElementById('project-detail');
            const loadingElement = document.getElementById('loading');
            const errorContainer = document.getElementById('error-container');
            
            if (!projectId) {
                showError(errorContainer, 'ID –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω');
                loadingElement.style.display = 'none';
                return;
            }
            
            try {
                const project = await getProjectById(projectId);
                loadingElement.style.display = 'none';
                displayProject(project);
                
            } catch (error) {
                loadingElement.style.display = 'none';
                showError(errorContainer, error.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞');
            }
        });
        
        function displayProject(project) {
            const projectContainer = document.getElementById('project-detail');
            const imageUrl = getImageUrl(project.image);
            const contacts = parseContacts(project.contact);
            
            projectContainer.innerHTML = `
                <div class="project-header">
                    <h1 class="project-title-detail">${project.title}</h1>
                    <p class="project-tagline">${project.tagline}</p>
                    
                    <div class="project-meta">
                        <div class="meta-item">
                            <span class="meta-icon">üìç</span>
                            <span>${project.city}, –†–æ—Å—Å–∏—è</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-icon">üìÖ</span>
                            <span>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: ${formatDate(project.createdAt)}</span>
                        </div>
                    </div>
                    
                    <div class="project-price-detail">${project.price.toLocaleString('ru-RU')} ‚ÇΩ</div>
                </div>
                
                ${imageUrl ? 
                    `<img src="${imageUrl}" alt="${project.title}" class="project-image-large">` : 
                    `<div class="no-image-placeholder-large">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ</div>`
                }
                
                <div class="project-content">
                    <div class="project-description-detail">
                        <h2 class="section-title">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</h2>
                        <div class="description-text">${project.description.replace(/\n/g, '<br>')}</div>
                    </div>
                    
                    <div class="contact-card">
                        <h2 class="section-title">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                        
                        ${contacts.phone ? `
                            <div class="contact-item">
                                <span class="contact-label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                                <div class="contact-value">
                                    <a href="tel:${contacts.phone.replace(/\D/g, '')}">${contacts.phone}</a>
                                </div>
                            </div>
                        ` : ''}
                        
                        ${contacts.email ? `
                            <div class="contact-item">
                                <span class="contact-label">Email:</span>
                                <div class="contact-value">
                                    <a href="mailto:${contacts.email}">${contacts.email}</a>
                                </div>
                            </div>
                        ` : ''}
                        
                        ${contacts.telegram ? `
                            <div class="contact-item">
                                <span class="contact-label">Telegram:</span>
                                <div class="contact-value">
                                    <a href="https://t.me/${contacts.telegram.replace('@', '')}" target="_blank">${contacts.telegram}</a>
                                </div>
                            </div>
                        ` : ''}
                        
                        ${contacts.otherContact ? `
                            <div class="contact-item">
                                <span class="contact-label">–î—Ä—É–≥–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã:</span>
                                <div class="contact-value">${contacts.otherContact}</div>
                            </div>
                        ` : ''}
                        
                        <button class="contact-btn-detail" onclick="showContact('${encodeURIComponent(project.contact)}')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã</button>
                    </div>
                </div>
            `;
            
            projectContainer.style.display = 'block';
        }
    </script>
</body>
</html>